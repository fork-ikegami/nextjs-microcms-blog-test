{"pageProps":{"blogData":[{"id":"m4qnmjr7rbi","createdAt":"2022-03-24T10:37:24.846Z","updatedAt":"2022-03-24T10:37:24.846Z","publishedAt":"2022-03-07T10:37:24.000Z","revisedAt":"2022-03-24T10:37:24.846Z","title":"gtagで複数のGoogleアナリティクスプロパティを設定する（GA4とUAどっちも書く）","body":"<h2 id=\"h5c0c7cb22e\">問題</h2><p>すでにGoogle AnalyticsのGlobal site tag（gtag）が埋め込まれているサイトで、新たにGA4のタグを追加してほしいと言われたので、調べてみました。</p><h2 id=\"h001d82110c\"><br>GA4とは</h2><blockquote>GA4は2020年10月にリリースされた新しいバージョンで、4番目のGoogleアナリティクスなので「Google Analytics 4（GA4）」とGoogleが名付けたそうです。 （正確には「Google Analytics for 4 プロパティ」のようです。） by&nbsp;<a href=\"https://weble.tokyo/blogs/ga4/1534/\" target=\"_blank\" rel=\"noopener noreferrer\">【GA4とUAを両方導入しよう】2021年版！初心者でもできるGoogleアナリティクスの導入方法 – WEBLE</a></blockquote><p>へ～ 計測・解析の面では結構機能が異なるようなのですが、埋め込む側としては見慣れたUAの後発って捉えておけば良さそうです。</p><h2 id=\"hd970156c24\"><br>対応</h2><p>たとえば UA-11111-1とG-22222を入れたい場合</p><pre><code>  &lt;!-- Global site tag (gtag.js) - Google Analytics --&gt;\n  &lt;script async src=\"https://www.googletagmanager.com/gtag/js?id=UA-11111-1\"&gt;&lt;/script&gt;\n  &lt;script&gt;\n    window.dataLayer = window.dataLayer || [];\n    function gtag() {\n      dataLayer.push(arguments);\n    }\n    gtag('js', new Date());\n    gtag('config', 'UA-11111-1');\n    gtag('config', 'G-22222');\n  &lt;/script&gt;</code></pre><p>これだけで大丈夫でした。 また、2行目の id= に入れるのはUA-でもG-でも大丈夫のようです。柔軟。<br>このとき、自分で計測データを見ていたわけではないので確実ではないのですが、&nbsp;<code>&lt;/head&gt;</code>の直前に置いていたときは動かず、Googleの指定通り<code>&lt;head&gt;</code>直後に置いたら動きました。</p><h2 id=\"h3de35099b3\"><br>参考</h2><p><a href=\"https://developers.google.com/analytics/devguides/collection/ga4/basic-tag?hl=ja&amp;technology=gtagjs\" target=\"_blank\" rel=\"noopener noreferrer\">ユニバーサル アナリティクスと Google アナリティクス 4 プロパティ用にタグを設定する方法 | Google Developers</a>&nbsp;<a href=\"https://developers.google.com/analytics/devguides/collection/ga4?hl=ja#add_an_additional_google_analytics_property_to_an_existing_tag\" target=\"_blank\" rel=\"noopener noreferrer\">既存のタグに Google アナリティクス プロパティを追加する</a>&nbsp;<a href=\"https://support.google.com/analytics/answer/10271001?hl=ja\" target=\"_blank\" rel=\"noopener noreferrer\">[GA4] analytics.js 実装のアップグレード</a>&nbsp;<a href=\"https://weble.tokyo/blogs/ga4/1534/\" target=\"_blank\" rel=\"noopener noreferrer\">【GA4とUAを両方導入しよう】2021年版！初心者でもできるGoogleアナリティクスの導入方法</a></p>","category":{"id":"web","createdAt":"2022-03-24T07:11:35.245Z","updatedAt":"2022-03-24T07:11:35.245Z","publishedAt":"2022-03-24T07:11:35.245Z","revisedAt":"2022-03-24T07:11:35.245Z","name":"Web全般"},"tag":[{"id":"google-analytics","createdAt":"2022-03-24T10:36:26.389Z","updatedAt":"2022-03-24T10:36:26.389Z","publishedAt":"2022-03-24T10:36:26.389Z","revisedAt":"2022-03-24T10:36:26.389Z","name":"GA"},{"id":"gtag","createdAt":"2022-03-24T10:36:41.527Z","updatedAt":"2022-03-24T10:36:41.527Z","publishedAt":"2022-03-24T10:36:41.527Z","revisedAt":"2022-03-24T10:36:41.527Z","name":"gtag"},{"id":"ga4","createdAt":"2022-03-24T10:36:53.897Z","updatedAt":"2022-03-24T10:36:53.897Z","publishedAt":"2022-03-24T10:36:53.897Z","revisedAt":"2022-03-24T10:36:53.897Z","name":"GA4"}]},{"id":"bksplxco9hzx","createdAt":"2022-03-24T10:35:04.947Z","updatedAt":"2022-03-24T10:35:04.947Z","publishedAt":"2022-02-21T10:35:04.000Z","revisedAt":"2022-03-24T10:35:04.947Z","title":"Firebase HostingにBasic認証かけるときのFunctionsはasia-northeast1じゃダメだった","body":"<p>リージョンは近い方が良いと聞いたことがあったので、開発のFunctionsをマネして東京リージョンにしたら hostingしたサイトにアクセスした際エラーになってしまいました。</p><blockquote>重要: HTTP 関数を使用して Firebase Hosting の動的コンテンツを提供する場合は、us-central1 を使用する必要があります。 by&nbsp;<a href=\"https://firebase.google.com/docs/functions/locations?hl=ja#http_and_client-callable_functions\" target=\"_blank\" rel=\"noopener noreferrer\">Cloud Functions のロケーション | Firebase</a></blockquote><p>デフォルトでリージョンは&nbsp;<code>us-central1</code>&nbsp;になるうえ、FunctionsでHostingするケースも少ないかと思うので、 とくにいじらなければ引っかからない箇所かと思います😂</p>","category":{"id":"web","createdAt":"2022-03-24T07:11:35.245Z","updatedAt":"2022-03-24T07:11:35.245Z","publishedAt":"2022-03-24T07:11:35.245Z","revisedAt":"2022-03-24T07:11:35.245Z","name":"Web全般"},"tag":[{"id":"firebase","createdAt":"2022-03-24T10:34:32.220Z","updatedAt":"2022-03-24T10:34:32.220Z","publishedAt":"2022-03-24T10:34:32.220Z","revisedAt":"2022-03-24T10:34:32.220Z","name":"Firebase"}]}],"totalCount":2},"__N_SSG":true}